device mps
训练集路径 fruit81_split/train
测试集路径 fruit81_split/val
训练集图像数量 11220
类别个数 81
各类别名称 ['人参果', '佛手瓜', '哈密瓜', '圣女果', '山楂', '山竹', '无花果', '木瓜', '李子', '杏', '杨桃', '杨梅', '枇杷', '枣', '柚子', '柠檬', '柿子', '树莓', '桂圆', '桑葚', '梨', '椰子', '榴莲', '樱桃', '橘子', '毛丹', '水蜜桃', '沃柑', '沙果', '沙棘', '油桃', '牛油果', '猕猴桃', '甘蔗', '甜瓜-伊丽莎白', '甜瓜-白', '甜瓜-绿', '甜瓜-金', '番石榴-百', '番石榴-红', '白兰瓜', '白心火龙果', '白萝卜', '百香果', '石榴', '砂糖橘', '粑粑柑', '红心火龙果', '红苹果', '羊奶果', '羊角蜜', '胡萝卜', '脐橙', '腰果', '芒果', '芦柑', '草莓', '荔枝', '莲雾', '菠萝', '菠萝莓', '菠萝蜜', '葡萄-白', '葡萄-红', '蓝莓', '蛇皮果', '蟠桃', '血橙', '西柚', '西梅', '西瓜', '西红柿', '车厘子', '酸角', '金桔', '青柠', '青苹果', '香橼', '香蕉', '黄桃', '黑莓']
测试集图像数量 2768
类别个数 81
各类别名称 ['人参果', '佛手瓜', '哈密瓜', '圣女果', '山楂', '山竹', '无花果', '木瓜', '李子', '杏', '杨桃', '杨梅', '枇杷', '枣', '柚子', '柠檬', '柿子', '树莓', '桂圆', '桑葚', '梨', '椰子', '榴莲', '樱桃', '橘子', '毛丹', '水蜜桃', '沃柑', '沙果', '沙棘', '油桃', '牛油果', '猕猴桃', '甘蔗', '甜瓜-伊丽莎白', '甜瓜-白', '甜瓜-绿', '甜瓜-金', '番石榴-百', '番石榴-红', '白兰瓜', '白心火龙果', '白萝卜', '百香果', '石榴', '砂糖橘', '粑粑柑', '红心火龙果', '红苹果', '羊奶果', '羊角蜜', '胡萝卜', '脐橙', '腰果', '芒果', '芦柑', '草莓', '荔枝', '莲雾', '菠萝', '菠萝莓', '菠萝蜜', '葡萄-白', '葡萄-红', '蓝莓', '蛇皮果', '蟠桃', '血橙', '西柚', '西梅', '西瓜', '西红柿', '车厘子', '酸角', '金桔', '青柠', '青苹果', '香橼', '香蕉', '黄桃', '黑莓']
   epoch  batch train_loss  train_accuracy
0      0      0   4.620167         0.03125
   epoch  test_loss  test_accuracy  test_precision  test_recall  test_f1-score
0    0.0   4.648617       0.011199           0.004     0.010543       0.004339
Epoch 1/30














































































































































100%|██████████| 351/351 [05:07<00:00,  1.14it/s]
保存新的最佳模型 checkpoint/best-0.617.pth
Epoch 2/30









































































100%|██████████| 351/351 [02:47<00:00,  2.09it/s]
  0%|          | 0/351 [00:00<?, ?it/s]
保存新的最佳模型 checkpoint/best-0.672.pth






















































100%|██████████| 351/351 [02:06<00:00,  2.77it/s]
保存新的最佳模型 checkpoint/best-0.695.pth
Epoch 4/30






















































100%|██████████| 351/351 [02:08<00:00,  2.74it/s]
保存新的最佳模型 checkpoint/best-0.702.pth
Epoch 5/30





































 62%|██████▏   | 217/351 [01:17<00:47,  2.81it/s]
Traceback (most recent call last):
  File "/Users/aspiriner/PycharmProjects/pythonProject1/TransforLearningPlus.py", line 229, in <module>
    log_train = train_one_batch(images, labels)
  File "/Users/aspiriner/PycharmProjects/pythonProject1/TransforLearningPlus.py", line 131, in train_one_batch
    outputs = model(images)  # 输入模型，执行前向预测
  File "/Users/aspiriner/opt/anaconda3/envs/ai01/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/aspiriner/opt/anaconda3/envs/ai01/lib/python3.8/site-packages/torchvision/models/resnet.py", line 285, in forward
    return self._forward_impl(x)
  File "/Users/aspiriner/opt/anaconda3/envs/ai01/lib/python3.8/site-packages/torchvision/models/resnet.py", line 273, in _forward_impl
    x = self.layer1(x)
  File "/Users/aspiriner/opt/anaconda3/envs/ai01/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/aspiriner/opt/anaconda3/envs/ai01/lib/python3.8/site-packages/torch/nn/modules/container.py", line 217, in forward
    input = module(input)
  File "/Users/aspiriner/opt/anaconda3/envs/ai01/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/aspiriner/opt/anaconda3/envs/ai01/lib/python3.8/site-packages/torchvision/models/resnet.py", line 93, in forward
    out = self.bn1(out)
  File "/Users/aspiriner/opt/anaconda3/envs/ai01/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/Users/aspiriner/opt/anaconda3/envs/ai01/lib/python3.8/site-packages/torch/nn/modules/batchnorm.py", line 171, in forward
    return F.batch_norm(
  File "/Users/aspiriner/opt/anaconda3/envs/ai01/lib/python3.8/site-packages/torch/nn/functional.py", line 2450, in batch_norm
    return torch.batch_norm(
